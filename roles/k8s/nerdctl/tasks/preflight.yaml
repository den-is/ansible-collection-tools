- name: Get current version if any
  ansible.builtin.shell: 'nerdctl --version | grep -E -o "[0-9]+\.[0-9]+\.[0-9]+"'
  register: check_nerdctl_currently_installed_v
  ignore_errors: true
  changed_when: false

- name: Registering current version
  ansible.builtin.set_fact:
    nerdctl_installed_v: '{{ check_nerdctl_currently_installed_v.stdout | default("0.0.0", true) }}'

- name: Output currently installed version
  ansible.builtin.debug:
    msg: 'Currently installed nerdctl version: {{ nerdctl_installed_v if check_nerdctl_currently_installed_v is success else "Not Available" }}'

- name: Check if zsh completions directory exists
  ansible.builtin.stat:
    path: '{{ nerdctl_zsh_completions_dst }}'
  register: check_zsh_completions_dir
